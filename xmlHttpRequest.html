<!-- CIT 261 XML HTTP Request page-->
<html>
    <head>
        <title>CIT 261 Weekly Technology Topics</title>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <link href="main.css" type="text/css" rel="stylesheet">
    </head>
    <body>
        <header>
            <h1>Ryan Weston</h1>

        </header>

        <ul id="navlist">
            <li id="active"><a href="index.html" id="current">Home</a></li>
        </ul>




    <h2>XML HTTP Request Page</h2>
    <p class="message box">
        The message is supposed to display here
    </p>
    <p>
        <button id="getMessage">
            Get Message
        </button>
    </p>


        <title>Example</title>

        <script>
            // Store XMLHttpRequest and the JSON file location in variables
            var xhr = new XMLHttpRequest();
            var url = "https://www.quackit.com/json/tutorial/artists.txt";

            // Called whenever the readyState attribute changes
            xhr.onreadystatechange = function() {

                // Check if fetch request is done
                if (xhr.readyState == 4 && xhr.status == 200) {

                    // Parse the JSON string
                    var jsonData = JSON.parse(xhr.responseText);

                    // Call the showArtists(), passing in the parsed JSON string
                    showArtists(jsonData);
                }
            };

            // Do the HTTP call using the url variable we specified above
            xhr.open("GET", url, true);
            xhr.send();

            // Function that formats the string with HTML tags, then outputs the result
            function showArtists(data) {
                var output = "<ul>"; // Open list
                var i;

                // Loop through the artists, and add them as list items
                for (var i in data.artists) {
                    output += "<li>" + data.artists[i].artistname + " (Born: " + data.artists[i].born + ")</li>";
                }

                output += "</ul>"; // Close list

                // Output the data to the "artistlist" element
                document.getElementById("artistList").innerHTML = output;
            }
        </script>

        <!-- The output appears here -->
        <div id="artistList"></div>







        <h2>The XMLHttpRequest Object</h2>

        <p id="demo">Somehow XML HTTP Request is supposed to change this text.</p>

        <button type="button" onclick="loadDoc()">Click me to Change My Content</button>

        <script>
            function loadDoc() {
                var xhttp;
                if (window.XMLHttpRequest) {
                    // code for modern browsers
                    xhttp = new XMLHttpRequest();
                } else {
                    // code for IE6, IE5
                    xhttp = new ActiveXObject("Microsoft.XMLHTTP");
                }
                xhttp.onreadystatechange = function() {
                    if (this.readyState == 4 && this.status == 200) {
                        document.getElementById("demo").innerHTML = this.responseText;
                    }
                };
                //send a request to a server
                xhttp.open("GET", "ajax_info.txt", true);
                xhttp.send();
            }
            function myFunction(xml) {
                var i;
                var xmlDoc = xml.responseXML;
                var table="<tr><th>Artist</th><th>Title</th></tr>";
                var x = xmlDoc.getElementsByTagName("CD");
                for (i = 0; i <x.length; i++) {
                    table += "<tr><td>" +
                        x[i].getElementsByTagName("ARTIST")[0].childNodes[0].nodeValue +
                        "</td><td>" +
                        x[i].getElementsByTagName("TITLE")[0].childNodes[0].nodeValue +
                        "</td></tr>";
                }
                document.getElementById("demo").innerHTML = table;
            }
        </script>



<footer>
    <p>Copyright &copy; 2019 Ryan Weston &nbsp; - &nbsp; Last updated: 11 May 2019</p>
</footer>
</body>
</html>
